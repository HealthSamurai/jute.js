---
suite: Expressions
tests:
  - desc: path with wildcard returns array of values
    scope: &goessner
      store:
        book:
          - category: "reference"
            author: "Nigel Rees"
            title: "Sayings of the Century"
            price: 8.95

          - category: "fiction"
            author: "Evelyn Waugh"
            title: "Sword of Honour"
            price: 12.99

          - category: "fiction"
            author: "Herman Melville"
            title: "Moby Dick"
            isbn: "0-553-21311-3"
            price: 8.99

          - category: "fiction"
            author: "J. R. R. Tolkien"
            title: "The Lord of the Rings"
            isbn: "0-395-19395-8"
            price: 22.99

        bicycle:
          color: "red"
          price: 19.95

        flower:
          - name: "Roses"
            color: "white"
            price: 1.3

      expensive: 10
    template:
      authors: $ store.book.*.author
    result:
      authors:
        - Nigel Rees
        - Evelyn Waugh
        - Herman Melville
        - J. R. R. Tolkien

  - desc: path without wildcard returns single value
    scope:
      <<: *goessner
    template:
      author: $ store.book.1.author
    result:
      author: "Evelyn Waugh"

  - desc: path allow to get single array element
    scope:
      <<: *goessner
    template:
      first: $ store.book.0
      second: $ store.book.1
    result:
      first:
        category: "reference"
        author: "Nigel Rees"
        title: "Sayings of the Century"
        price: 8.95

      second:
        category: "fiction"
        author: "Evelyn Waugh"
        title: "Sword of Honour"
        price: 12.99

  - desc: path with deep wildcards collects all values regardless its level
    scope:
      <<: *goessner
    template:
      prices: $ store.**.price
    result:
      prices:
        - 8.95
        - 12.99
        - 8.99
        - 22.99
        - 19.95
        - 1.3

  - desc: path with multiple wildcards returns array of values
    scope:
      <<: *goessner
    template:
      prices: $ store.*.*.price
    result:
      prices:
        - 8.95
        - 12.99
        - 8.99
        - 22.99
        - 1.3

  - desc: path with predicate selectes values which satisfies expression
    scope:
      <<: *goessner
    template:
      cheap_books: $ store.book.*(@.price < 10).title
      reference_book: $ store.book.*(@.category = 'reference').title
    result:
      reference_book:
        - "Sayings of the Century"

      cheap_books:
        - "Sayings of the Century"
        - "Moby Dick"

  - desc: path with wildcards collects all available elements
    scope: {"a": 3, "b": 5, "c": [true, false]}
    template:
      a: $ @.*
      b: $ c.*
    result:
      a: [3, 5, [true, false]]
      b: [true, false]

  - desc: path can contain single element
    scope:
      foo: 12
    template:
      bar: $ foo
    result:
      bar: 12

  - desc: plus adds numbers
    scope:
    template:
      bar: $ 2 + 6 - 10
    result:
      bar: -2

  - desc: complex algebraic expression
    scope:
    template:
      ex1: $ 2 + 3 * 3
      ex2: $ 2 + 3 / 3
    result:
      ex1: 11
      ex2: 3

  - desc: negation negates number
    scope:
    template:
      bar: $ -10
    result:
      bar: -10

  - desc: union operator performs union operation on it\'s operands
    scope:
      <<: *goessner
      a: [10, true, {foo: {bar: "a"}}]
      b: [20, "hello!", {foo: {bar: "a"}}]
    template:
      bar: $ a | b
      baz: $ store.book | store.flower
    result:
      bar:
        - 10
        - true
        - {foo: {bar: "a"}}
        - 20
        - "hello!"
      baz:
        12

  - desc: path expressions change path scope
    scope:
      <<: *goessner
    template:
      bar: $ store.(book | flower).*.price
    result:
      bar:
        - 8.95
        - 12.99
        - 8.99
        - 22.99
        - 1.3
